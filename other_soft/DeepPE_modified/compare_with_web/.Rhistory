View(web)
seq_47nt = "AAAAAAGGATACAGTTTCTGTAAGTGGATCCAAGTTACTGAAAAGCT"
pbs = "ACAGAAA"
rtt = "GGATCGACTT"
system(command= paste(str("../../other_soft/DeepPE_modified/DeepPE_main.py --seq_47nt "),
seq_47nt,
str(" --pbs "),
pbs,
str(" --rtt "),
rtt,
sep=""))
system(command= paste(str("../../other_soft/DeepPE_modified/DeepPE_main.py --seq_47nt "),
seq_47nt,
str(" --pbs "),
pbs,
str(" --rtt "),
rtt,
sep=""))
paste(c(str("../../other_soft/DeepPE_modified/DeepPE_main.py --seq_47nt "),
seq_47nt,
str(" --pbs "),
pbs,
str(" --rtt "),
rtt),
sep="")
paste(c(str("../../other_soft/DeepPE_modified/DeepPE_main.py --seq_47nt "),
seq_47nt,
str(" --pbs "),
pbs,
str(" --rtt "),
rtt),
sep="")
paste(str("../../other_soft/DeepPE_modified/DeepPE_main.py --seq_47nt "),seq_47nt,str(" --pbs "),pbs, str(" --rtt "),rtt, sep="")
paste(str("../../other_soft/DeepPE_modified/DeepPE_main.py --seq_47nt "),seq_47nt,str(" --pbs "),pbs, str(" --rtt "),rtt, sep="")
paste(str("../../other_soft/DeepPE_modified/DeepPE_main.py --seq_47nt "),seq_47nt)
paste(str("../../other_soft/DeepPE_modified/DeepPE_main.py --seq_47nt "),str(seq_47nt))
paste(str("../../other_soft/DeepPE_modified/DeepPE_main.py --seq_47nt "),str(seq_47nt),sep="")
k = paste(str("../../other_soft/DeepPE_modified/DeepPE_main.py --seq_47nt "),str(seq_47nt),sep="")
k
k = paste("../../other_soft/DeepPE_modified/DeepPE_main.py --seq_47nt ",seq_47nt,sep="")
k
command = paste("../../other_soft/DeepPE_modified/DeepPE_main.py --seq_47nt ",seq_47nt," --pbs ",pbs," --rtt ",rtt, sep="")
system(command)
command = paste("../../DeepPE_modified/DeepPE_main.py --seq_47nt ",seq_47nt," --pbs ",pbs," --rtt ",rtt, sep="")
res = system(command)
res = system(command)
command = paste("python ../../DeepPE_modified/DeepPE_main.py --seq_47nt ",seq_47nt," --pbs ",pbs," --rtt ",rtt, sep="")
res = system(command)
setwd("~/Downloads/Sanger/01.Project/gitrepos/my_repositories/FlashFry/other_soft/DeepPE_modified/compare_with_web/")
web = read.table("web_example_DeepPE_Scores.txt",sep="\t",head=TRUE)
com = read.table("command_Scores.txt",sep="\t",head=TRUE)
View(web)
ncol(web)
nrow(web)
nrow(web)
nrow(com)
com = [2:nrow(com),]
com = com[2:nrow(com),]
sum = cbind(web[1:8,],web[10,],web[9,],com)
View(sum)
sum = cbind(web[,1:8],web[,10],web[,9],com)
View(sum)
colnames(sum[,9:11]) = c("Model","Web","Command")
View(sum)
colnames(sum)[9:11] = c("Model","Web","Command")
cor(sum$Web,sum$Command)
dpe = sum[which(sum$Model=="DeepPE"),]
cor(dpe$Web,dpe$Command)
dpe = sum[which(sum$Model=="DeepPE"),]
pos = sum[which(sum$Model=="PE_Position"),]
type = sum[which(sum$Model=="PE_Type"),]
unique(sum[,3])
ncol(sum)
nrow(sum)
1424/25
summary(sum[,3])
table(sum[,3])
pos = sum[which(sum$Model=="PE_Position"),]
type = sum[which(sum$Model=="PE_Type"),]
cor(dpe$Web,dpe$Command)
cor(pos$Web,pos$Command)
cor(type$Web,type$Command)
type$web
type = sum[which(sum$Model=="PE_type"),]
cor(type$Web,type$Command)
cor(pos$Web,pos$Command)
unique(sum[,3])
#57
par(mfrow=c(5,5))
1:len(unique(sum[,3]))
(1:length(unique(sum[,3])))
par(mfrow=c(1,1))
s = 1
spacer = unique(sum[,3])[s]
each = sum[which(sum[,3]==spacer),]
cor(dpe$Web,dpe$Command,method = "Wilcoxon")
t.test(dpe$web, dpe$Command,method = "Wilcoxon")
?t.test
t.test(dpe$web, dpe$Command,paired=TRUE,var.equal=FALSE)
t.test(dpe$Web, dpe$Command,paired=TRUE,var.equal=FALSE)
stripchart(Web ~ Model, data = each,
main = "Model",
pch = 16,
col = c("red", "green","blue"))
View(each)
stripchart(Web ~ Model, data = each,
main = "Model",
pch = 16,
col = c("red", "green","blue"))
dim(each)
colnames(each)
colnames(sum) = c("ID","Location","Wide","Edit","PBS_len","RTT_len","Edit","Model","Web","Command")
par(mfrow=c(1,1))
s = 1
spacer = unique(sum[,3])[s]
each = sum[which(sum[,3]==spacer),]
colnames(each)
sum = cbind(web[,1:8],web[,10],web[,9],com)
colnames(sum) = c("ID","Location","Wide","Edit","PBS_len","RTT_len","Edit","Model","Web","Command")
View(sum)
sum = cbind(web[,1:8],web[,10],web[,9],com)
View(sum)
colnames(sum) = c("ID","Location","Wide","Guide","Edit","PBS_len","RTT_len","Extension","Model","Web","Command")
View(sum)
cor(sum$Web,sum$Command)
dpe = sum[which(sum$Model=="DeepPE"),]
pos = sum[which(sum$Model=="PE_Position"),]
type = sum[which(sum$Model=="PE_type"),]
cor(dpe$Web,dpe$Command)
print(c(dpe,pos,type))
print(c(dpe,pos,type))
cor(dpe$Web,dpe$Command)
#t.test(dpe$Web, dpe$Command,paired=TRUE,var.equal=FALSE)
cor(pos$Web,pos$Command)
cor(type$Web,type$Command)
par(mfrow=c(1,1))
s = 1
spacer = unique(sum[,3])[s]
each = sum[which(sum[,3]==spacer),]
colnames(each)
stripchart(Web ~ Model, data = each,
main = "Model",
pch = 16,
col = c("red", "green","blue"))
stripchart(Web ~ Model, data = each,
main = "Model",
pch = 16,
col = c("red", "green","blue"),
vertical = TRUE)
par(mfrow=c(5,5))
for s in (1:length(unique(sum[,3]))){
spacer = unique(sum[,3])[s]
each = sum[which(sum[,3]==spacer),]
stripchart(Web ~ Model, data = each,
main = "Model",
pch = 16,
col = c("red", "green","blue"),
group.names=c("DeepPE","PE_position","PE_type")
vertical = TRUE)
}
(1:length(unique(sum[,3])))
(1:length(unique(sum[,3])))
for (i in 1:length(unique(sum[,3]))){
spacer = unique(sum[,3])[i]
each = sum[which(sum[,3]==spacer),]
stripchart(Web ~ Model, data = each,
main = "Model",
pch = 16,
col = c("red", "green","blue"),
group.names=c("DeepPE","PE_position","PE_type"),
vertical = TRUE)
}
par(mfrow=c(5,5))
for (i in 1:length(unique(sum[,3]))){
spacer = unique(sum[,3])[i]
each = sum[which(sum[,3]==spacer),]
stripchart(Web ~ Model, data = each,
main = "Model",
ylab = "Web Score"
pch = 16,
col = c("red", "green","blue"),
group.names=c("DeepPE","PE_position","PE_type"),
vertical = TRUE)
}
for (i in 1:5){ #1:length(unique(sum[,3]))
spacer = unique(sum[,3])[i]
each = sum[which(sum[,3]==spacer),]
stripchart(Web ~ Model, data = each,
main = "Model",
ylab = "Web Score"
pch = 16,
col = c("red", "green","blue"),
group.names=c("DeepPE","PE_position","PE_type"),
vertical = TRUE)
}
for (i in (1:5)){ #1:length(unique(sum[,3]))
spacer = unique(sum[,3])[i]
each = sum[which(sum[,3]==spacer),]
stripchart(Web ~ Model, data = each,
main = "Model",
ylab = "Web Score",
pch = 16,
col = c("red", "green","blue"),
group.names=c("DeepPE","PE_position","PE_type"),
vertical = TRUE)
}
#57
par(mfrow=c(1,5))
for (i in (1:5)){ #1:length(unique(sum[,3]))
spacer = unique(sum[,3])[i]
each = sum[which(sum[,3]==spacer),]
stripchart(Web ~ Model, data = each,
main = "Model",
ylab = "Web Score",
pch = 16,
col = c("red", "green","blue"),
group.names=c("DeepPE","PE_position","PE_type"),
vertical = TRUE)
}
par(mfrow=c(5,1))
for (i in (1:5)){ #1:length(unique(sum[,3]))
spacer = unique(sum[,3])[i]
each = sum[which(sum[,3]==spacer),]
stripchart(Web ~ Model, data = each,
main = "Model",
ylab = "Web Score",
pch = 16,
col = c("red", "green","blue"),
group.names=c("DeepPE","PE_position","PE_type"),
vertical = FALSE)
}
par(mfrow=c(5,1))
for (i in (1:5)){ #1:length(unique(sum[,3]))
spacer = unique(sum[,3])[i]
each = sum[which(sum[,3]==spacer),]
stripchart(Web ~ Model, data = each,
ylab = "Web Score",
pch = 16,
col = c("red", "green","blue"),
group.names=c("DeepPE","PE_position","PE_type"),
vertical = FALSE)
}
# library
library(ggplot2)
# grouped boxplot
ggplot(sum, aes(x=Wide, y=Web, fill=Model)) +
geom_boxplot()
ggplot2.stripchart(data=sum, xName='Wide',yName='Web',
groupName='Model',
position=position_dodge(0.8),
backgroundColor="white", groupColors=c('#999999','#E69F00',"#111111"))
install.packages("devtools")
library(devtools)
install_github("easyGgplot2", "kassambara")
library(easyGgplot2)
p<-ggplot(sum, aes(x=Wide, y=Web, color=Model, shape=Model)) +
geom_jitter(position=position_dodge(0.8))
p
p<-ggplot(sum, aes(x=Wide, y=Web, color=Model, shape=Model)) +
geom_jitter(position=position_dodge(0.8)) +
scale_color_brewer(palette="Blues") + theme_classic()
p
p<-ggplot(sum, aes(x=Wide, y=Web, color=Model, shape=Model)) +
geom_jitter(position=position_dodge(0.8)) +
scale_color_brewer(palette="Blues") + theme_classic() +
scale_fill_continuous(trans = 'reverse')
p
p<-ggplot(sum, aes(x=Wide, y=Web, color=Model, shape=Model)) +
geom_jitter(position=position_dodge(0.8)) +
scale_color_brewer(palette="Blues",direction=-1) + theme_classic()
p
for (i in 1:25){}
for (i in 1:25){
for (i in 1:25){
out = c(out, paste("\"",i,"\"",sep=""))
}
out = c()
for (i in 1:25){
out = c(out, paste("\"",i,"\"",sep=""))
}
out
out = c()
for (i in 1:25){
out = c(out, paste(\",i,\",sep=""))
}
out
out = c()
for (i in 1:25){
out = c(out, paste('\"',i,'\"',sep=""))
}
out
out = c()
for (i in 1:25){
out = c(out, paste('"',i,'"',sep=""))
}
out
p<-ggplot(sum, aes(x=Wide, y=Web, color=Model, shape=Model)) +
geom_jitter(position=position_dodge(0.8)) +
scale_color_brewer(palette="Blues",direction=-1) + theme_classic() +
labels = c("1","2","3","4","5","6","7","8","9","10","11","12",
"13","14","15","16","17","18","19","20")
p
p<-ggplot(sum, aes(x=Wide, y=Web, color=Model, shape=Model)) +
geom_jitter(position=position_dodge(0.8)) +
scale_color_brewer(palette="Blues",direction=-1) + theme_classic() +
scale_x_discrete(labels=c("1","2","3","4","5","6","7","8","9","10","11","12",
"13","14","15","16","17","18","19","20"))
p
p<-ggplot(sum, aes(x=Wide, y=Web, color=Model, shape=Model)) +
geom_jitter(position=position_dodge(0.8)) +
scale_color_brewer(palette="Blues",direction=-1) + theme_classic() +
scale_x_discrete(labels=c("1","2","3","4","5","6","7","8","9","10","11","12",
"13","14","15","16","17","18","19","20"))+
labs(y= "Web score", x = "Spacer")
p
p<-ggplot(sum, aes(x=Wide, y=Web, color=Model, shape=Model)) +
geom_jitter(position=position_dodge(0.8)) +
scale_color_brewer(palette="Blues",direction=-1) + theme_classic() +
scale_x_discrete(labels=c("1","2","3","4","5","6","7","8","9","10","11","12",
"13","14","15","16","17","18","19","20","21","22","23","24","25"))+
labs(y= "Web score", x = "Spacer")
p
dpe = sum[which(sum$Model=="DeepPE"),]
pos = sum[which(sum$Model=="PE_Position"),]
type = sum[which(sum$Model=="PE_type"),]
cor(dpe$Web,dpe$Command)
#t.test(dpe$Web, dpe$Command,paired=TRUE,var.equal=FALSE)
cor(pos$Web,pos$Command)
cor(type$Web,type$Command)
plot(dpe$Web,dpe$Command)
par(mfrow=c(1,1))
plot(dpe$Web,dpe$Command)
par(new=T)
abline(a=0,b=1,lty=1,lwd=2)
p <-ggplot(dpe, aes(Web, Command)) + geom_point()
p + geom_abline(slope = 1)
p <-ggplot(dpe, aes(Web, Command)) + geom_point() +
labs(x= "Web score", y = "Command score") +
theme(axis.title.y = element_text(size=12)+
theme(axis.title.x = element_text(size=12)
p + geom_abline(slope = 1)
p <-ggplot(dpe, aes(Web, Command)) + geom_point() +
labs(x= "Web score", y = "Command score") +
theme(axis.title.y = element_text(size=12)) +
theme(axis.title.x = element_text(size=12))
p + geom_abline(slope = 1)
p <-ggplot(dpe, aes(Web, Command)) + geom_point() +
labs(x= "Web score", y = "Command score") +
theme(axis.title.y = element_text(size=14)) +
theme(axis.title.x = element_text(size=14))
p + geom_abline(slope = 1)
p <-ggplot(dpe, aes(Web, Command)) + geom_point() +
labs(x= "Web score", y = "Command score") +
theme(axis.title.y = element_text(size=14)) +
theme(axis.title.x = element_text(size=14))
p + geom_abline(slope = 1,color="blue")
dpe = sum[which(sum$Model=="DeepPE"),]
cor(dpe$Web,dpe$Command)
t.test(dpe$Web,dpe$Command,paired=TRUE,var.equal=FALSE)
cor(dpe$Web,dpe$Command,method="Spearman")
cor(dpe$Web,dpe$Command,method="spearman")
hist(dpe$Web)
hist(dpe$Web,breaks=100)
hist(dpe$Web,breaks=100,main="Web score distribution",xlab="Web score")
hist(dpe$Web,breaks=100,main="DeepPE Web score distribution",xlab="DeepPE Web score")
cor(dpe$Web,dpe$Command,method="spearman")
hist(dpe$Command,breaks=100,main="DeepPE Web score distribution",xlab="DeepPE Web score")
par(mfrow=c(2,1))
hist(dpe$Web,breaks=100,main="DeepPE Web score distribution",xlab="DeepPE Web score")
hist(dpe$Command,breaks=100,main="DeepPE Command score distribution",xlab="DeepPE Command score")
par(mfrow=c(1,1))
p <-ggplot(dpe, aes(Web, Command)) + geom_point() +
labs(title="DeepPE",x= "Web score", y = "Command score") +
theme(axis.title.y = element_text(size=14)) +
theme(axis.title.x = element_text(size=14))
p + geom_abline(slope = 1,color="blue")
par(mfrow=c(1,1))
p <-ggplot(dpe, aes(Web, Command)) + geom_point() +
labs(title="DeepPE score comparison",x= "Web score", y = "Command score") +
theme(axis.title.y = element_text(size=14)) +
theme(axis.title.x = element_text(size=14))
p + geom_abline(slope = 1,color="blue")
par(mfrow=c(1,1))
p <-ggplot(dpe, aes(Web, Command)) + geom_point(size=0.8) +
labs(title="DeepPE score comparison",x= "Web score", y = "Command score") +
theme(axis.title.y = element_text(size=14)) +
theme(axis.title.x = element_text(size=14))
p + geom_abline(slope = 1,color="blue")
sum10 = sum[which(sum[,3]%in%unique(sum[,3])[1:10]),]
p<-ggplot(sum10, aes(x=Wide, y=Web, color=Model, shape=Model)) +
geom_jitter(position=position_dodge(0.8)) +
scale_color_brewer(palette="Blues",direction=-1) + theme_classic() +
scale_x_discrete(labels=c("1","2","3","4","5","6","7","8","9","10"))+
labs(y= "Web score", x = "Spacer")
p
sum10 = sum[which(sum[,3]%in%unique(sum[,3])[1:10]),]
p<-ggplot(sum10, aes(x=Wide, y=Web, color=Model, shape=Model)) +
geom_jitter(position=position_dodge(0.8)) +
scale_color_brewer(palette="Blues",direction=-1) + theme_classic() +
scale_x_discrete(labels=c("1","2","3","4","5","6","7","8","9","10"))+
labs(y= "Web score", x = "Spacer")+
theme(axis.title.y = element_text(size=14)) +
theme(axis.title.x = element_text(size=14))+
theme(legend.title = element_text(size=14)) +
theme(legend.text = element_text(size=14))
p
p<-ggplot(sum10, aes(x=Wide, y=Web, color=Model, shape=Model)) +
geom_jitter(position=position_dodge(1)) +
scale_color_brewer(palette="Blues",direction=-1) + theme_classic() +
scale_x_discrete(labels=c("1","2","3","4","5","6","7","8","9","10"))+
labs(y= "Web score", x = "Spacer")+
theme(axis.title.y = element_text(size=14)) +
theme(axis.title.x = element_text(size=14))+
theme(legend.title = element_text(size=14)) +
theme(legend.text = element_text(size=14))
p
p<-ggplot(sum10, aes(x=Wide, y=Web, color=Model, shape=Model)) +
geom_jitter(position=position_dodge(1.3)) +
scale_color_brewer(palette="Blues",direction=-1) + theme_classic() +
scale_x_discrete(labels=c("1","2","3","4","5","6","7","8","9","10"))+
labs(y= "Web score", x = "Spacer")+
theme(axis.title.y = element_text(size=14)) +
theme(axis.title.x = element_text(size=14))+
theme(legend.title = element_text(size=14)) +
theme(legend.text = element_text(size=14))
p
p<-ggplot(sum10, aes(x=Wide, y=Web, color=Model, shape=Model)) +
geom_jitter(position=position_dodge(0.8),size=1.2) +
scale_color_brewer(palette="Blues",direction=-1) + theme_classic() +
scale_x_discrete(labels=c("1","2","3","4","5","6","7","8","9","10"))+
labs(y= "Web score", x = "Spacer")+
theme(axis.title.y = element_text(size=14)) +
theme(axis.title.x = element_text(size=14))+
theme(legend.title = element_text(size=14)) +
theme(legend.text = element_text(size=14))
p
p<-ggplot(sum10, aes(x=Wide, y=Web, color=Model, shape=Model)) +
geom_jitter(position=position_dodge(0.8),size=3) +
scale_color_brewer(palette="Blues",direction=-1) + theme_classic() +
scale_x_discrete(labels=c("1","2","3","4","5","6","7","8","9","10"))+
labs(y= "Web score", x = "Spacer")+
theme(axis.title.y = element_text(size=14)) +
theme(axis.title.x = element_text(size=14))+
theme(legend.title = element_text(size=14)) +
theme(legend.text = element_text(size=14))
p
p<-ggplot(sum10, aes(x=Wide, y=Web, color=Model, shape=Model)) +
geom_jitter(position=position_dodge(0.8),size=2) +
scale_color_brewer(palette="Blues",direction=-1) + theme_classic() +
scale_x_discrete(labels=c("1","2","3","4","5","6","7","8","9","10"))+
labs(y= "Web score", x = "Spacer")+
theme(axis.title.y = element_text(size=14)) +
theme(axis.title.x = element_text(size=14))+
theme(legend.title = element_text(size=14)) +
theme(legend.text = element_text(size=14))
p
dpe$PBS_RTT_len = dpe$PBS_len + RTT_len
dpe$PBS_RTT_len = dpe$PBS_len + dpe$RTT_len
ggplot(dpe, aes(x=Spacer, y=Web, , size=2, color=PBS_RTT_len)) +
geom_point() +
scale_color_gradient(low="blue", high="red")
View(dpe)
ggplot(dpe, aes(x=Wide, y=Web, , size=2, color=PBS_RTT_len)) +
geom_point() +
scale_color_gradient(low="blue", high="red")
ggplot(dpe, aes(x=Wide, y=Web, , size=2, color=PBS_RTT_len)) +
geom_point() +
scale_color_gradient(low="white", high="red")
ggplot(dpe, aes(x=Wide, y=Web, , size=1, color=PBS_RTT_len)) +
geom_point() +
scale_color_gradient(low="white", high="red")
ggplot(dpe, aes(x=Wide, y=Web, , size=1, color=PBS_RTT_len)) +
geom_point(size=0.4) +
scale_color_gradient(low="white", high="red")
ggplot(dpe, aes(x=Wide, y=Web, , size=2, color=PBS_RTT_len)) +
geom_point(size=0.8) +
scale_color_gradient(low="white", high="red")
ggplot(dpe, aes(x=Wide, y=Web, , size=2, color=PBS_RTT_len)) +
geom_point(size=1.5) +
scale_color_gradient(low="white", high="red")
ggplot(dpe, aes(x=Wide, y=Web, , size=2, color=PBS_RTT_len)) +
geom_point(size=1.5) +
scale_color_gradient(low="white", high="red")+
scale_x_discrete(labels=c("1","2","3","4","5","6","7","8","9","10"))+
labs(y= "Web score", x = "Spacer")+
theme(axis.title.y = element_text(size=14)) +
theme(axis.title.x = element_text(size=14))+
theme(legend.title = element_text(size=14)) +
theme(legend.text = element_text(size=14))
ggplot(dpe, aes(x=Wide, y=Web, , size=2, color=PBS_RTT_len)) +
geom_point(size=1.5) +
scale_color_gradient(low="white", high="red")+
scale_x_discrete(labels=c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25"))+
labs(y= "Web score", x = "Spacer")+
theme(axis.title.y = element_text(size=14)) +
theme(axis.title.x = element_text(size=14))+
theme(legend.title = element_text(size=14)) +
theme(legend.text = element_text(size=14))
ggplot(dpe, aes(x=Wide, y=Web, , size=2, color=PBS_RTT_len)) +
geom_point(size=1.5) +
scale_color_gradient(low="red", high="white")+
scale_x_discrete(labels=c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25"))+
labs(y= "Web score", x = "Spacer")+
theme(axis.title.y = element_text(size=14)) +
theme(axis.title.x = element_text(size=14))+
theme(legend.title = element_text(size=14)) +
theme(legend.text = element_text(size=14))
com2 = read.table("command_Scores_woGtoC.txt",sep="\t",head=TRUE)
com2 =  com[2:nrow(com),]
com2 =  com2[2:nrow(com2),]
sum2 =  cbind(web[,1:8],web[,10],web[,9],com2)
colnames(sum2) = c("ID","Location","Wide","Guide","Edit","PBS_len","RTT_len","Extension","Model","Web","Command")
